p2table := [['65536', '65025', '64516', '64009', '63504', '63001', '62500', '62001', '61504', '61009', '60516', '60025', '59536', '59049', '58564', '58081', '57600', '57121', '56644', '56169', '55696', '55225', '54756', '54289', '53824', '53361', '52900', '52441', '51984', '51529', '51076', '50625', '50176', '49729', '49284', '48841', '48400', '47961', '47524', '47089', '46656', '46225', '45796', '45369', '44944', '44521', '44100', '43681', '43264', '42849', '42436', '42025', '41616', '41209', '40804', '40401', '40000', '39601', '39204', '38809', '38416', '38025', '37636', '37249', '36864', '36481', '36100', '35721', '35344', '34969', '34596', '34225', '33856', '33489', '33124', '32761', '32400', '32041', '31684', '31329', '30976', '30625', '30276', '29929', '29584', '29241', '28900', '28561', '28224', '27889', '27556', '27225', '26896', '26569', '26244', '25921', '25600', '25281', '24964', '24649', '24336', '24025', '23716', '23409', '23104', '22801', '22500', '22201', '21904', '21609', '21316', '21025', '20736', '20449', '20164', '19881', '19600', '19321', '19044', '18769', '18496', '18225', '17956', '17689', '17424', '17161', '16900', '16641', '16384', '16129', '15876', '15625', '15376', '15129', '14884', '14641', '14400', '14161', '13924', '13689', '13456', '13225', '12996', '12769', '12544', '12321', '12100', '11881', '11664', '11449', '11236', '11025', '10816', '10609', '10404', '10201', '10000', '9801', '9604', '9409', '9216', '9025', '8836', '8649', '8464', '8281', '8100', '7921', '7744', '7569', '7396', '7225', '7056', '6889', '6724', '6561', '6400', '6241', '6084', '5929', '5776', '5625', '5476', '5329', '5184', '5041', '4900', '4761', '4624', '4489', '4356', '4225', '4096', '3969', '3844', '3721', '3600', '3481', '3364', '3249', '3136', '3025', '2916', '2809', '2704', '2601', '2500', '2401', '2304', '2209', '2116', '2025', '1936', '1849', '1764', '1681', '1600', '1521', '1444', '1369', '1296', '1225', '1156', '1089', '1024', '961', '900', '841', '784', '729', '676', '625', '576', '529', '484', '441', '400', '361', '324', '289', '256', '225', '196', '169', '144', '121', '100', '81', '64', '49', '36', '25', '16', '9', '4', '1', '0', '1', '4', '9', '16', '25', '36', '49', '64', '81', '100', '121', '144', '169', '196', '225', '256', '289', '324', '361', '400', '441', '484', '529', '576', '625', '676', '729', '784', '841', '900', '961', '1024', '1089', '1156', '1225', '1296', '1369', '1444', '1521', '1600', '1681', '1764', '1849', '1936', '2025', '2116', '2209', '2304', '2401', '2500', '2601', '2704', '2809', '2916', '3025', '3136', '3249', '3364', '3481', '3600', '3721', '3844', '3969', '4096', '4225', '4356', '4489', '4624', '4761', '4900', '5041', '5184', '5329', '5476', '5625', '5776', '5929', '6084', '6241', '6400', '6561', '6724', '6889', '7056', '7225', '7396', '7569', '7744', '7921', '8100', '8281', '8464', '8649', '8836', '9025', '9216', '9409', '9604', '9801', '10000', '10201', '10404', '10609', '10816', '11025', '11236', '11449', '11664', '11881', '12100', '12321', '12544', '12769', '12996', '13225', '13456', '13689', '13924', '14161', '14400', '14641', '14884', '15129', '15376', '15625', '15876', '16129', '16384', '16641', '16900', '17161', '17424', '17689', '17956', '18225', '18496', '18769', '19044', '19321', '19600', '19881', '20164', '20449', '20736', '21025', '21316', '21609', '21904', '22201', '22500', '22801', '23104', '23409', '23716', '24025', '24336', '24649', '24964', '25281', '25600', '25921', '26244', '26569', '26896', '27225', '27556', '27889', '28224', '28561', '28900', '29241', '29584', '29929', '30276', '30625', '30976', '31329', '31684', '32041', '32400', '32761', '33124', '33489', '33856', '34225', '34596', '34969', '35344', '35721', '36100', '36481', '36864', '37249', '37636', '38025', '38416', '38809', '39204', '39601', '40000', '40401', '40804', '41209', '41616', '42025', '42436', '42849', '43264', '43681', '44100', '44521', '44944', '45369', '45796', '46225', '46656', '47089', '47524', '47961', '48400', '48841', '49284', '49729', '50176', '50625', '51076', '51529', '51984', '52441', '52900', '53361', '53824', '54289', '54756', '55225', '55696', '56169', '56644', '57121', '57600', '58081', '58564', '59049', '59536', '60025', '60516', '61009', '61504', '62001', '62500', '63001', '63504', '64009', '64516'], 256]

p3table := [['-1.6777216e+07', '-1.6581375e+07', '-1.6387064e+07', '-1.6194277e+07', '-1.6003008e+07', '-1.5813251e+07', '-1.5625e+07', '-1.5438249e+07', '-1.5252992e+07', '-1.5069223e+07', '-1.4886936e+07', '-1.4706125e+07', '-1.4526784e+07', '-1.4348907e+07', '-1.4172488e+07', '-1.3997521e+07', '-1.3824e+07', '-1.3651919e+07', '-1.3481272e+07', '-1.3312053e+07', '-1.3144256e+07', '-1.2977875e+07', '-1.2812904e+07', '-1.2649337e+07', '-1.2487168e+07', '-1.2326391e+07', '-1.2167e+07', '-1.2008989e+07', '-1.1852352e+07', '-1.1697083e+07', '-1.1543176e+07', '-1.1390625e+07', '-1.1239424e+07', '-1.1089567e+07', '-1.0941048e+07', '-1.0793861e+07', '-1.0648e+07', '-1.0503459e+07', '-1.0360232e+07', '-1.0218313e+07', '-1.0077696e+07', '-9.938375e+06', '-9.800344e+06', '-9.663597e+06', '-9.528128e+06', '-9.393931e+06', '-9.261e+06', '-9.129329e+06', '-8.998912e+06', '-8.869743e+06', '-8.741816e+06', '-8.615125e+06', '-8.489664e+06', '-8.365427e+06', '-8.242408e+06', '-8.120601e+06', '-8e+06', '-7.880599e+06', '-7.762392e+06', '-7.645373e+06', '-7.529536e+06', '-7.414875e+06', '-7.301384e+06', '-7.189057e+06', '-7.077888e+06', '-6.967871e+06', '-6.859e+06', '-6.751269e+06', '-6.644672e+06', '-6.539203e+06', '-6.434856e+06', '-6.331625e+06', '-6.229504e+06', '-6.128487e+06', '-6.028568e+06', '-5.929741e+06', '-5.832e+06', '-5.735339e+06', '-5.639752e+06', '-5.545233e+06', '-5.451776e+06', '-5.359375e+06', '-5.268024e+06', '-5.177717e+06', '-5.088448e+06', '-5.000211e+06', '-4.913e+06', '-4.826809e+06', '-4.741632e+06', '-4.657463e+06', '-4.574296e+06', '-4.492125e+06', '-4.410944e+06', '-4.330747e+06', '-4.251528e+06', '-4.173281e+06', '-4.096e+06', '-4.019679e+06', '-3.944312e+06', '-3.869893e+06', '-3.796416e+06', '-3.723875e+06', '-3.652264e+06', '-3.581577e+06', '-3.511808e+06', '-3.442951e+06', '-3.375e+06', '-3.307949e+06', '-3.241792e+06', '-3.176523e+06', '-3.112136e+06', '-3.048625e+06', '-2.985984e+06', '-2.924207e+06', '-2.863288e+06', '-2.803221e+06', '-2.744e+06', '-2.685619e+06', '-2.628072e+06', '-2.571353e+06', '-2.515456e+06', '-2.460375e+06', '-2.406104e+06', '-2.352637e+06', '-2.299968e+06', '-2.248091e+06', '-2.197e+06', '-2.146689e+06', '-2.097152e+06', '-2.048383e+06', '-2.000376e+06', '-1.953125e+06', '-1.906624e+06', '-1.860867e+06', '-1.815848e+06', '-1.771561e+06', '-1.728e+06', '-1.685159e+06', '-1.643032e+06', '-1.601613e+06', '-1.560896e+06', '-1.520875e+06', '-1.481544e+06', '-1.442897e+06', '-1.404928e+06', '-1.367631e+06', '-1.331e+06', '-1.295029e+06', '-1.259712e+06', '-1.225043e+06', '-1.191016e+06', '-1.157625e+06', '-1.124864e+06', '-1.092727e+06', '-1.061208e+06', '-1.030301e+06', '-1e+06', '-970299', '-941192', '-912673', '-884736', '-857375', '-830584', '-804357', '-778688', '-753571', '-729000', '-704969', '-681472', '-658503', '-636056', '-614125', '-592704', '-571787', '-551368', '-531441', '-512000', '-493039', '-474552', '-456533', '-438976', '-421875', '-405224', '-389017', '-373248', '-357911', '-343000', '-328509', '-314432', '-300763', '-287496', '-274625', '-262144', '-250047', '-238328', '-226981', '-216000', '-205379', '-195112', '-185193', '-175616', '-166375', '-157464', '-148877', '-140608', '-132651', '-125000', '-117649', '-110592', '-103823', '-97336', '-91125', '-85184', '-79507', '-74088', '-68921', '-64000', '-59319', '-54872', '-50653', '-46656', '-42875', '-39304', '-35937', '-32768', '-29791', '-27000', '-24389', '-21952', '-19683', '-17576', '-15625', '-13824', '-12167', '-10648', '-9261', '-8000', '-6859', '-5832', '-4913', '-4096', '-3375', '-2744', '-2197', '-1728', '-1331', '-1000', '-729', '-512', '-343', '-216', '-125', '-64', '-27', '-8', '-1', '0', '1', '8', '27', '64', '125', '216', '343', '512', '729', '1000', '1331', '1728', '2197', '2744', '3375', '4096', '4913', '5832', '6859', '8000', '9261', '10648', '12167', '13824', '15625', '17576', '19683', '21952', '24389', '27000', '29791', '32768', '35937', '39304', '42875', '46656', '50653', '54872', '59319', '64000', '68921', '74088', '79507', '85184', '91125', '97336', '103823', '110592', '117649', '125000', '132651', '140608', '148877', '157464', '166375', '175616', '185193', '195112', '205379', '216000', '226981', '238328', '250047', '262144', '274625', '287496', '300763', '314432', '328509', '343000', '357911', '373248', '389017', '405224', '421875', '438976', '456533', '474552', '493039', '512000', '531441', '551368', '571787', '592704', '614125', '636056', '658503', '681472', '704969', '729000', '753571', '778688', '804357', '830584', '857375', '884736', '912673', '941192', '970299', '1e+06', '1.030301e+06', '1.061208e+06', '1.092727e+06', '1.124864e+06', '1.157625e+06', '1.191016e+06', '1.225043e+06', '1.259712e+06', '1.295029e+06', '1.331e+06', '1.367631e+06', '1.404928e+06', '1.442897e+06', '1.481544e+06', '1.520875e+06', '1.560896e+06', '1.601613e+06', '1.643032e+06', '1.685159e+06', '1.728e+06', '1.771561e+06', '1.815848e+06', '1.860867e+06', '1.906624e+06', '1.953125e+06', '2.000376e+06', '2.048383e+06', '2.097152e+06', '2.146689e+06', '2.197e+06', '2.248091e+06', '2.299968e+06', '2.352637e+06', '2.406104e+06', '2.460375e+06', '2.515456e+06', '2.571353e+06', '2.628072e+06', '2.685619e+06', '2.744e+06', '2.803221e+06', '2.863288e+06', '2.924207e+06', '2.985984e+06', '3.048625e+06', '3.112136e+06', '3.176523e+06', '3.241792e+06', '3.307949e+06', '3.375e+06', '3.442951e+06', '3.511808e+06', '3.581577e+06', '3.652264e+06', '3.723875e+06', '3.796416e+06', '3.869893e+06', '3.944312e+06', '4.019679e+06', '4.096e+06', '4.173281e+06', '4.251528e+06', '4.330747e+06', '4.410944e+06', '4.492125e+06', '4.574296e+06', '4.657463e+06', '4.741632e+06', '4.826809e+06', '4.913e+06', '5.000211e+06', '5.088448e+06', '5.177717e+06', '5.268024e+06', '5.359375e+06', '5.451776e+06', '5.545233e+06', '5.639752e+06', '5.735339e+06', '5.832e+06', '5.929741e+06', '6.028568e+06', '6.128487e+06', '6.229504e+06', '6.331625e+06', '6.434856e+06', '6.539203e+06', '6.644672e+06', '6.751269e+06', '6.859e+06', '6.967871e+06', '7.077888e+06', '7.189057e+06', '7.301384e+06', '7.414875e+06', '7.529536e+06', '7.645373e+06', '7.762392e+06', '7.880599e+06', '8e+06', '8.120601e+06', '8.242408e+06', '8.365427e+06', '8.489664e+06', '8.615125e+06', '8.741816e+06', '8.869743e+06', '8.998912e+06', '9.129329e+06', '9.261e+06', '9.393931e+06', '9.528128e+06', '9.663597e+06', '9.800344e+06', '9.938375e+06', '1.0077696e+07', '1.0218313e+07', '1.0360232e+07', '1.0503459e+07', '1.0648e+07', '1.0793861e+07', '1.0941048e+07', '1.1089567e+07', '1.1239424e+07', '1.1390625e+07', '1.1543176e+07', '1.1697083e+07', '1.1852352e+07', '1.2008989e+07', '1.2167e+07', '1.2326391e+07', '1.2487168e+07', '1.2649337e+07', '1.2812904e+07', '1.2977875e+07', '1.3144256e+07', '1.3312053e+07', '1.3481272e+07', '1.3651919e+07', '1.3824e+07', '1.3997521e+07', '1.4172488e+07', '1.4348907e+07', '1.4526784e+07', '1.4706125e+07', '1.4886936e+07', '1.5069223e+07', '1.5252992e+07', '1.5438249e+07', '1.5625e+07', '1.5813251e+07', '1.6003008e+07', '1.6194277e+07', '1.6387064e+07'], 256]

fn tableLookup(i, table) (table.0).(i + table.1) |> float()
fn p2tableLook(i) tableLookup(i, p2table)
fn p3tableLook(i) tableLookup(i, p2table)

fn exp(x) pow(math.E, x)
fn qdiv(a, b) exp(log(a) - log(b))

fn qd_b4(x) if r := tableLookup(x) {
  ? -> x |> pow(2)
  _ -> r
} / 4

fn hkmlt(a, b) if {
  a = 1
  b = 1 -> 1
  _ -> qd_b4(a + b) - qd_b4(a - b)
}